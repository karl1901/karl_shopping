import{r as e,E as t}from"./index-fa007f95.js";import{computed as l,ref as u,reactive as a}from"vue";import{E as o}from"./el-message-c349120f.js";import{E as r}from"./el-overlay-9d820482.js";import"./typescript-5028724d.js";const n={class:"dialog-footer"},i=Vue.defineComponent({__name:"dialog",props:{visible:{type:Boolean},updateId:null,modelValue:null},emits:["update:modelValue","update:visible","update:updateId","update:table"],setup(t,{emit:a}){const r=t,i=((e,t,u)=>l({get:()=>new Proxy(e[t],{set:(e,l,a)=>(u(`update:${t}`,{...e,[l]:a}),!0)}),set(e){u(`update:${t}`,e)}}))(r,"modelValue",a),d=u(),s=u(!1),p=()=>{var e;c.value=void 0,V.value=!1,null==(e=d.value)||e.formRef.resetFields(),i.value={}},V=l({get:()=>r.visible,set(e){a("update:visible",e)}}),c=l({get:()=>r.updateId,set(e){a("update:updateId",e)}}),f=()=>{var t;null==(t=d.value)||t.formRef.validate((t=>{if(!t)return!1;{s.value=!0;const t={system_config:{info:i.value.info,scid:i.value.scid,value:i.value.value}};void 0===c.value||function(t){return e({url:"/SystemConfig/Update",method:"post",data:t})}(t).then((({success:e,message:t})=>{e?(o.success(t),a("update:table"),p()):o.error(t)})).catch((e=>{})).finally((()=>{s.value=!1}))}}))},m=[{field:"info",label:"系统配置描述",type:"input",placeholder:"请输入系统配置描述",rules:[{required:!0,message:"请输入系统配置描述",trigger:"blur"}]},{field:"value",label:"系统配置值",type:"input",placeholder:"请输入系统配置值",rules:[{required:!0,message:"请输入系统配置值",trigger:"blur"}]}];return(e,t)=>{const l=Vue.resolveComponent("Form"),u=Vue.resolveComponent("el-button"),a=Vue.resolveComponent("el-dialog"),o=Vue.resolveDirective("loading");return Vue.openBlock(),Vue.createBlock(a,{modelValue:Vue.unref(V),"onUpdate:modelValue":t[0]||(t[0]=e=>Vue.isRef(V)?V.value=e:null),title:void 0===Vue.unref(c)?"新增系统配置":"修改系统配置",width:"80%",onClose:p,"close-on-click-modal":!1},{footer:Vue.withCtx((()=>[Vue.createElementVNode("span",n,[Vue.createVNode(u,{onClick:p,plain:""},{default:Vue.withCtx((()=>[Vue.createTextVNode("取 消")])),_:1}),Vue.createVNode(u,{type:"primary",onClick:f,plain:""},{default:Vue.withCtx((()=>[Vue.createTextVNode("保 存")])),_:1})])])),default:Vue.withCtx((()=>[Vue.withDirectives(Vue.createVNode(l,{ref_key:"baseForm",ref:d,formItems:m,formData:Vue.unref(i)},null,8,["formData"]),[[o,Vue.unref(s)]])])),_:1},8,["modelValue","title"])}}}),d={class:"app-container"},s=Vue.defineComponent({name:"SystemConfig"}),p=Vue.defineComponent({...s,setup(n){const s=a({info:""}),p=u(),V=u({}),c=u(void 0),f=u(!1),m=[{label:"配置描述",prop:"info",width:"200px"},{label:"配置关键词",prop:"key",width:"200px"},{label:"配置值",prop:"value",width:"200px"},{label:"创建时间",prop:"create_time",type:"date"},{label:"最后修改时间",prop:"lastupdate_time",type:"date"}],v=()=>{var e;null==(e=p.value)||e.handleSearch()},h=()=>{r.confirm("此操作将重置所有数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{p.value.loading=!0,e({url:"/SystemConfig/Reset",method:"post"}).then((({success:e,message:t})=>{var l;e?(o.success(t),null==(l=p.value)||l.handleSearch()):o.error(t)})).catch((e=>{o.error("重置失败")}))})).catch((e=>{"cancel"===e?o.info("已取消重置"):o.error("重置失败")}))},C=()=>{t({title:"提示",message:"暂不支持新增系统配置",type:"warning"})},g=l((()=>({system_config:{info:s.info}}))),y=e=>{f.value=!0,c.value=e.scid,V.value=JSON.parse(JSON.stringify(e))},b=()=>{var e;null==(e=p.value)||e.getDataModelList()};return(e,t)=>{const l=Vue.resolveComponent("el-input"),u=Vue.resolveComponent("el-form-item"),a=Vue.resolveComponent("el-button"),o=Vue.resolveComponent("el-form"),r=Vue.resolveComponent("Table");return Vue.openBlock(),Vue.createElementBlock("div",d,[Vue.createVNode(o,{ref:"form",inline:""},{default:Vue.withCtx((()=>[Vue.createVNode(u,null,{default:Vue.withCtx((()=>[Vue.createVNode(l,{modelValue:Vue.unref(s).info,"onUpdate:modelValue":t[0]||(t[0]=e=>Vue.unref(s).info=e),modelModifiers:{trim:!0},clearable:"",placeholder:"配置描述"},null,8,["modelValue"])])),_:1}),Vue.createVNode(u,null,{default:Vue.withCtx((()=>[Vue.createVNode(a,{type:"primary",onClick:v,plain:""},{default:Vue.withCtx((()=>[Vue.createTextVNode("搜索")])),_:1})])),_:1}),Vue.createVNode(u,null,{default:Vue.withCtx((()=>[Vue.createVNode(a,{type:"info",onClick:h,plain:""},{default:Vue.withCtx((()=>[Vue.createTextVNode("重置")])),_:1})])),_:1}),Vue.createVNode(u,null,{default:Vue.withCtx((()=>[Vue.createVNode(a,{type:"success",onClick:C,plain:""},{default:Vue.withCtx((()=>[Vue.createTextVNode("新增")])),_:1})])),_:1})])),_:1},512),Vue.createVNode(i,{"onUpdate:table":b,updateId:Vue.unref(c),"onUpdate:updateId":t[1]||(t[1]=e=>Vue.isRef(c)?c.value=e:null),visible:Vue.unref(f),"onUpdate:visible":t[2]||(t[2]=e=>Vue.isRef(f)?f.value=e:null),modelValue:Vue.unref(V),"onUpdate:modelValue":t[3]||(t[3]=e=>Vue.isRef(V)?V.value=e:null)},null,8,["updateId","visible","modelValue"]),Vue.createVNode(r,{ref_key:"table",ref:p,tableColumnList:m,dataModel:"SystemConfig",queryWapper:Vue.unref(g),hasDelete:!1,operateWidth:200,onHandleEdit:y},null,8,["queryWapper"])])}}});export{p as default};
